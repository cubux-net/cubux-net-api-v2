Тип `Cubux.Sync.DataDiff`
=========================

Базовый тип, характеризующий разницу по отношению к базовой ревизии в
конкретном контексте.

Возникает посредством [запроса разницы][api-diff].

Объект **расширяет** тип [`Cubux.Sync.Data`][Cubux.Sync.Data] следующими
полями:

Поле              | Тип      | Описание
----------------- | -------- | --------
`base_revision`   | `uuid`   | UUID базовой ревизии, по отношению к которой вычислены изменения
`deleted_objects` | `object` | Словарь удалений объектов данного контекста

Хотя данный тип расширяет базовый тип
[`Cubux.Sync.Data`][Cubux.Sync.Data], смысл наследованного поля
`objects` изменяется. В этом типе содержатся лишь те объекты, которые
были изменены или добавлены после момента времени, соответствующему
запрошенной базовой ревизии.

Поле `deleted_objects`, аналогично полю `objects`, содержит поля, имена
которых соответствуют типам объектов в данном контексте. Конкретный
список полей (разновидности объектов) см. в описании производных типов
для конкретного [контекста][context].

Конкретные экземпляры объектов внутри `deleted_objects` несут в себе
только ключевые поля для идентификации конкретных объектов.

**Важно:** Для типов объектов с простым первичным ключом вместо объекта
с единственным полем будет фигурировать непосредственно значение этого
поля. Например, разница изменений в некой команде:

    {
        "base_revision": "004b143f-b748-4c7e-b183-cb146c2ff463",
        "deleted_objects": {
            "accounts": [
                "265ae802-5418-4ac0-b777-ed6855787453",
                "49196ae8-5853-482f-ae13-08dfd9d49577"
            ],
            "accounts_access": [
                {
                    "user_uuid":    "0fdafba5-b3e6-47d8-bd12-c2b23957598e",
                    "account_uuid": "265ae802-5418-4ac0-b777-ed6855787453"
                },
                ...
            },
            ...
        }
    }

Счета в команде идентифицируются простым ключом `uuid`, поэтому в списке
удалений перечисляется сразу значения поля `uuid`. В то же время, права
участников на счета идентифицируются составным ключом
(`user_uuid`,`account_uuid`), поэтому с их списке удалений фигурируют
объекты с такими полями.


[api-diff]: ../../sync/api/diff.md
[context]: ../../sync/02-context.md
[Cubux.Sync.Data]: data.md
