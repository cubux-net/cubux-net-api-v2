Тип `Cubux.Sync.ObjectErrors`
=============================

Объект описывает набор ошибок, выявленных в данных, отправленых запросом
[отправки изменений][api-submit].

Объект со следующими полями:

Поле        | Тип            | Описание
----------- | -------------- | --------
`section`   | `string`       | 1й уровень
`entity`    | `string`, NULL | 2й уровень — тип объекта
`key`       | `object`, NULL | 3й уровень — идентификатор объекта
`attribute` | `string`, NULL | 4й уровень — поле объекта
`messages` | `Array:`[`Cubux.Sync.ErrorMessage`][Cubux.Sync.ErrorMessage] | Сообщения

Поля объекта `section`, `entity`, `key` и `attribute` (будучи
перечисленными именно в таком порядке) соответствуют уровню вложенности
проблемного места в объекте
[`Cubux.Sync.DataPatch`][Cubux.Sync.DataPatch], к которому относятся
сообщения об ошибках, перечисленные в поле `messages`.

Так, первое поле `section` содержит имя поле самого объекта
[`Cubux.Sync.DataPatch`][Cubux.Sync.DataPatch] (например, `"objects"`
или `"deleted_objects"`).

Второе поле `entity` (когда `section` есть `"objects"` или
`"deleted_objects"`) содержит тип объектов согласно набору объектов в
данном [контексте][context].

Третье поле `key` (когда заполнено поле `entity`), может быть заполнено
объектом, содержащим ключевые поля для идентификации конкретного
объекта. Поле `key` будет иметь значение NULL, если объект данного типа
(указанного в поле `entity`) существует в единственном экземпляре
(например, объект `me` в данных пользователя и объект `info` в данных
команды). Также поле `key` будет иметь значение NULL, когда ошибки
относятся во всему списку объектов данного типа, а не к конкретному
объекту.

Последнее четвертое поле `attribute` будет содержать имя поля
конкретного объекта, выбранного предыдущими полями. Поле `attribute`
будет иметь значение NULL, если ошибки имеют отношение не к конкретному
полю объекта, а ко всему объекту целиком (или одновременно к нескольким
полям, что почти то же самое).

#### Пример

Предположим, были отправлены следующие изменения — отправка чека со
ссылкой на уже загруженый ранее файл.

    {
        "objects": {
            "drafts": [
                {
                    "uuid":       "69e5905c-ec81-48ca-b37a-8b36db4699c1",
                    "image_blob": "Bbrno6_wrYTQlHuVBe23ULDauANXpWge"
                }
            ]
        }
    }

Если принятие этих изменений было отклонено (`status` у тикета есть
`"aborted"`), то один из объектов набора ошибок (массив `errors` у
тикета) может быть таким:

    {
        "section": "objects",
        "entity":  "drafts",
        "key": {
            "uuid": "69e5905c-ec81-48ca-b37a-8b36db4699c1"
        },
        "attribute": "image_blob",
        "messages": [
            {
                "level":   "user_error",
                "code":    "input",
                "message": "File reference is outdated"
            }
        ]
    }


[api-submit]: ../../sync/api/submit.md
[context]: ../../sync/02-context.md
[Cubux.Sync.DataPatch]: data-patch.md
[Cubux.Sync.ErrorMessage]: error-message.md
