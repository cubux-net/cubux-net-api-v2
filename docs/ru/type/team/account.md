Тип `Cubux.Account`
===================

Счёт.

Объект со следующими полями:

Поле | Тип | Описание
---- | --- | --------
**`uuid`** PK    | `uuid`        | UUID
`name`           | `string`      | **Обязательно**. Название
`bank_uuid`      | `uuid`, NULL  | UUID банка. Если не указано, то "наличные вне банка".
`country_code`   | `string(3)`   | **Обязательно**. Код страны
`currency_code`  | `string(3)`   | **Обязательно**. Код валюты
`initial_amount` | `decimal(.10)`, NULL | Сумма начального остатка/долга (отрицательная сума — долг)
`initial_date`   | `date`, NULL  | Дата транзакции для первоначального остатка
`sort`           | `integer`     | Порядковый номер для сортировки. Произвольные числа. Рекомендуется использовать шаг больше 1 для более удобной вставки между соседями. Например: 10, 20, 30, ... или 100, 200, 300, ... Перенумерация соседей при изменении не обязательна, но уместна.
`icon_name`      | `string`      | Имя иконки. Максимум 32 символа.
`icon_uuid`      | `uuid`, NULL  | UUID иконки [`Cubux.Image`][Cubux.Image]
`group_uuid`     | `uuid`, NULL  | UUID [`Cubux.AccountGroup`][Cubux.AccountGroup] для группировки
`is_hidden`      | `boolean`     | Счет скрыт
`is_excluded`    | `boolean`     | Счет не учитывается в общем остатке команды
`is_locked` _(только чтение)_ | `boolean` | Счет блокирован (см. ниже)
`auth_uuid`      | `uuid`, NULL  | UUID счета [`Cubux.BankSync.AuthAccount`][Cubux.BankSync.AuthAccount] для связи с реальным банком
`auth_login_uuid` | `uuid`, NULL | UUID логина [`Cubux.BankSync.AuthLogin`][Cubux.BankSync.AuthLogin] для связи с реальным банком
`daily_refresh` _(только чтение)_ | `boolean`, NULL | Разрешено ли автоматическое обновление данных для синхронизации с реальным банком
`user_refresh` _(только чтение)_ | `boolean`, NULL | Разрешено ли пользователю ручное обновление данных для синхронизации с реальным банком
`is_sync_lost` _(только чтение)_ | `boolean` | Для счетов, связанными с реальными банками, значение `true` говорит о том, что связь утрачена (см. поле `sync_lost_reason`)
`last_sync_date` _(только чтение)_ | `datetime`, NULL | Время последнего сеанса синхронизации с реальным банком
`refresh_wanted_at` _(только чтение)_ | `datetime`, NULL | Время последнего пожелания провести синхронизацию с банком (АПИ запрос `refresh`).
`login_id` _(только чтение, устаревшее)_ | `uint64`, NULL   | ID Логина для синхронизации с реальным банком
`next_refresh_possible_at` _(только чтение)_ | `datetime`, NULL | Когда будет разрешено запросить обновление данных при синхронизации с реальным банком.
`sync_lost_reason` _(только чтение)_ | `string`, NULL | Для счетов, связанными с реальными банками, код причины утраты связи
`sync_error_class` _(только чтение)_ | `string`, NULL | Для счетов, связанными с реальными банками, тип ошибки для на стороне нашего АПИ.
`sync_error_message` _(только чтение)_ | `string`, NULL | Для счетов, связанными с реальными банками, сообщение об ошибке. Может содержать текст ошибки, принятый из АПИ банка.

**Замечание:** Управлять счетами могут только Администраторы команды.

Код причины утраты связи `sync_lost_reason` может иметь следующие значения:

Код | Описание
--- | --------
`interactive_timeout`             | Срок жизни интерактивного подтверждения истёк
`invalid_credentials`             | Учетный данные (обычно логин и пароль) неверны
`invalid_interactive_credentials` | Данные интерактивного подтверждения (например, код из СМС) неверны
`oauth_token`                     | Токен доступа устарел или отозван
`remote_account_deleted`          | Целевой счёт не существует
`remote_auth_outdated`            | Выданные разрешения устарели или отозваны, либо идентификационные данные пользователя устарели


### Блокированный счёт

Блокированный счёт не может быть использован для проведения операций.
Например, для счёта настроена интеграция с банком, откуда импортируются
реальные операции.


[Cubux.AccountGroup]: account-group.md
[Cubux.Image]: image.md
[Cubux.BankSync.AuthAccount]: ../bank-sync/auth-account.md
[Cubux.BankSync.AuthLogin]: ../bank-sync/auth-login.md
